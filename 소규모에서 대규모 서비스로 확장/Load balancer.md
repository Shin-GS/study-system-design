# Load Balancer 정리

## 1. Load Balancer란?
- 여러 서버에 들어오는 트래픽을 **효율적으로 분산**시켜주는 장치(혹은 소프트웨어)  
- 클라이언트는 로드 밸런서를 통해 요청을 보내고, 로드 밸런서가 적절한 서버로 분배  
- 대규모 시스템에서 **가용성(Availability)**과 **확장성(Scalability)**을 확보하는 핵심 요소  

---

## 2. 주요 역할
- **트래픽 분산 (Traffic Distribution)**  
  특정 서버가 과부하되지 않도록 요청을 여러 서버에 균등하게 분산  
- **장애 감지 (Health Check)**  
  서버 상태를 주기적으로 확인하고, 다운된 서버로는 요청을 보내지 않음  
- **고가용성 (High Availability)**  
  일부 서버가 고장 나더라도 서비스 전체는 지속 운영 가능  
- **SSL 종료 (SSL Termination)**  
  HTTPS 암호화를 로드 밸런서에서 처리 → 서버 부담 감소  
- **세션 유지 (Sticky Session)**  
  같은 사용자의 요청을 특정 서버에 고정시킬 수 있음  

---

## 3. 로드 밸런싱 알고리즘
1. **Round Robin** — 요청을 순서대로 각 서버에 분배  
2. **Least Connections** — 현재 연결 수가 가장 적은 서버로 분배  
3. **IP Hash** — 클라이언트 IP를 해싱하여 특정 서버에 매핑 (세션 일관성 유지)  
4. **Weighted Round Robin** — 서버 성능에 따라 가중치를 주어 분배  

---

## 4. Load Balancer의 종류
- **L4 로드 밸런서** (전송 계층, TCP/UDP 기반)  
  - IP와 포트 기반으로 트래픽을 분배  
  - 빠르고 단순하지만 애플리케이션 레벨 정보는 알 수 없음  
- **L7 로드 밸런서** (애플리케이션 계층, HTTP/HTTPS 기반)  
  - URL, 쿠키, HTTP 헤더 기반으로 세밀한 분배 가능  
  - 복잡하지만 유연하고 강력함  

---

## 5. 장단점
- **장점**
  - 트래픽 분산으로 성능 향상  
  - 장애 허용성(Fault Tolerance) 강화  
  - 서비스 확장 용이  
- **단점**
  - 로드 밸런서 자체가 장애 발생 시 Single Point of Failure → 이중화 필요  
  - 추가 인프라/운영 비용 발생  

---

## 6. 실무 팁
- **이중화(HA)**: 로드 밸런서도 최소 2대 운영(Active-Active 또는 Active-Standby)  
- **헬스 체크**: 애플리케이션 레벨 헬스 엔드포인트(`/healthz`) 구현  
- **세션 관리**: 가능하면 스티키 세션 대신 외부 세션 저장소(Redis 등) 사용  
- **관측성**: 요청 지표(QPS, 에러율, 지연시간)와 상태코드 분포 대시보드화  
- **보안**: L7에서 TLS 종료 후, 서버 간 통신은 내부망으로 제한  

---

👉 한 줄 요약: 로드 밸런서는 단순 분산 장치가 아니라 **가용성·보안·운영 효율**을 함께 책임지는 핵심 인프라입니다.
